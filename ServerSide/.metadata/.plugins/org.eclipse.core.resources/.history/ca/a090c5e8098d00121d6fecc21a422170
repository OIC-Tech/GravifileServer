package com.louishong.gravifile;

import java.sql.ResultSet;
import java.sql.SQLException;


public class ProfileWrapper {
	public static String sDriver = "org.sqlite.JDBC";
	public static String sUrl = "jdbc:sqlite:/Users/honglouis/Documents/ServerWorkspace/Gravifile/src/com/louishong/database/Profiles.sqlite";

	
	static public String getLastName(String name) {
		SQliteBase sqlBase = new SQliteBase(sDriver, sUrl);
		System.out.println(sqlBase == null);
		ResultSet results = sqlBase.executeQuery("SELECT * FROM Profiles");

		String resultName;
		try {

			while (results.next()) {
				resultName = results.getString("FirstName");
				if (resultName.equals(name)) {
					return results.getString("LastName");
				}
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return null;
	}

	static public String getUserPoint(String name) {
		SQliteBase sqlBase = new SQliteBase(sDriver, sUrl);
		ResultSet results = sqlBase.executeQuery("SELECT * FROM Profiles");

		String resultName;
		try {

			while (results.next()) {
				resultName = results.getString("FirstName");
				if (resultName.equals(name)) {
					return results.getString("UserPoint");
				}
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return null;
	}

	static public String getEmail(String name) {
		SQliteBase sqlBase = new SQliteBase(sDriver, sUrl);
		ResultSet results = sqlBase.executeQuery("SELECT * FROM Profiles");

		String resultName;
		try {

			while (results.next()) {
				resultName = results.getString("FirstName");
				if (resultName.equals(name)) {
					return results.getString("Email");
				}
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return null;
	}

	static public String getGender(String name) {
		SQliteBase sqlBase = new SQliteBase(sDriver, sUrl);
		ResultSet results = sqlBase.executeQuery("SELECT * FROM Profiles");

		String resultName;
		try {

			while (results.next()) {
				resultName = results.getString("FirstName");
				if (resultName.equals(name)) {
					return results.getString("Gender");
				}
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return null;
	}

	static public String getIsMember(String name) {
		SQliteBase sqlBase = new SQliteBase(sDriver, sUrl);
		ResultSet results = sqlBase.executeQuery("SELECT * FROM Profiles");

		String resultName;
		try {

			while (results.next()) {
				resultName = results.getString("FirstName");
				if (resultName.equals(name)) {
					
					return results.getString("IsMember");
				}
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return null;
	}

	static public Boolean hasUser(String name) {
		SQliteBase sqlBase = new SQliteBase(sDriver, sUrl);
		ResultSet results = sqlBase.executeQuery("SELECT * FROM Profiles");

		String resultName;
		try {

			while (results.next()) {
				resultName = results.getString("FirstName");
				if (resultName.equals(name)) {
					return true;
				}
			}
		} catch (SQLException e) {
			e.printStackTrace();
		}
		return false;
	}
}
