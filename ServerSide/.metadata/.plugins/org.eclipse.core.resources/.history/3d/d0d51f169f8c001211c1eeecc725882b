package com.louishong.database;

import java.sql.ResultSet;
import java.sql.SQLException;

public class ProfileWrapper {
	public static String sDriver = "org.sqlite.JDBC";
	public static String sUrl = "jdbc:sqlite:/Users/honglouis/Documents/ServerWorkspace/Gravifile/src/com/louishong/database/Profiles.sqlite";
	public static SQliteBase sqlBase = new SQliteBase(sDriver, sUrl);

	String getLastName(String name) throws SQLException {
		ResultSet results = sqlBase.executeQuery("SELECT * FROM Profiles");

		String resultName;
		while (results.next()) {
			resultName = results.getString("FirstName");
			if (resultName.equals(name)) {
				return results.getString("LastName");

			}
		}
		return null;
	}

	String getUserPoint(String name) throws SQLException {
		ResultSet results = sqlBase.executeQuery("SELECT * FROM Profiles");

		String resultName;
		while (results.next()) {
			resultName = results.getString("FirstName");
			if (resultName.equals(name)) {
				return results.getString("UserPoint");
			}
		}
		return null;
	}

	String getEmail(String name) throws SQLException {
		ResultSet results = sqlBase.executeQuery("SELECT * FROM Profiles");

		String resultName;
		while (results.next()) {
			resultName = results.getString("FirstName");
			if (resultName.equals(name)) {
				return results.getString("Email");
			}
		}

		return null;
	}

	String getGender(String name) throws SQLException {
		ResultSet results = sqlBase.executeQuery("SELECT * FROM Profiles");

		String resultName;
		while (results.next()) {
			resultName = results.getString("FirstName");
			if (resultName.equals(name)) {
				return results.getString("Gender");
			}
		}
		return null;
	}

	String getIsMember(String name) throws SQLException {
		ResultSet results = sqlBase.executeQuery("SELECT * FROM Profiles");

		String resultName;
			while (results.next()) {
				resultName = results.getString("FirstName");
				if (resultName.equals(name)) {

					return results.getString("IsMember");
				}
			}
		return null;
	}

	Boolean hasUser(String name) throws SQLException {
		ResultSet results = sqlBase.executeQuery("SELECT * FROM Profiles");

		String resultName;
		try {

			while (results.next()) {
				resultName = results.getString("FirstName");
				if (resultName.equals(name)) {
					return true;
				}
			}
		} catch (SQLException e) {
			e.printStackTrace();
		}
		return false;
	}
}
