package com.louishong.database;

import java.sql.Statement;
import java.sql.Connection;
import java.sql.Driver;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;

class SQliteBase {
	public static String sDriver;
	public static String sUrl;
	public static Connection con;
	public static ResultSet result = null;

	public void setDriver(String driver) {
		// Register Driver #1
		try {
			Driver d = (Driver) Class.forName(driver).newInstance();
			DriverManager.registerDriver(d);
		} catch (Exception e) {
			e.printStackTrace();
		}

	}

	public void createConnection() throws SQLException {
		con = DriverManager.getConnection(sUrl);

	}

	public ResultSet executeQuery(String sql) throws SQLException {

		// Execute SQL Query using Statement object
		Statement stmt;
		
		stmt = con.createStatement();
		result = stmt.executeQuery(sql);
		con.close();
		return result;

	}

	public SQliteBase(String stringDriver, String stringUrl) {

		sDriver = stringDriver;
		sUrl = stringUrl;

		// Register Driver #1
		setDriver(sDriver);

		// Create Connection
		try {
			createConnection();
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}

}
